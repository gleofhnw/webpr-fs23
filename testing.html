<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Scope Tests</title>
</head>
<body>
<script>
  /*function two() {
    x = 2;
    return x;
  }

  try {
    x;
    document.writeln(true);
  } catch(e) {
    document.writeln(false);
  }
  false
  */

  /*function two() {
    let x = 2;
    return x;
  }
  try {
    x;
    document.writeln(true);
  } catch(e) {
    document.writeln(false);
  }

  false*/

  /*let x = 0;
  function two() {
    let x = 2;
    return x;
  }
  try {
    x;
    document.writeln(x === 0);
  } catch(e) {
    document.writeln(false);
  }

  true*/

  /*function two() {
    x = 2;
    return x;
  }

  two();
  try {
    x;
    document.writeln(true);
  } catch(e) {
    document.writeln(false);
  }

  true*/

  /*let x = 0;
  function two() {
    x = 2;
    return x;
  }

  two();

  try {
    x;
    document.writeln(x === 0);
  } catch(e) {
    document.writeln(false);
  }

  false*/

  /*let x = 0;
  (function two() {
    let x = 2;
    return x;
  })();

  try {
    document.writeln(x === 0);
  } catch (e){
    document.writeln(false);
  }

  // true*/

  /*let x = 0;
  function two() {
    let x = 2;
    return x;
  }
  two();

  try {
    document.writeln(x === 0);
  } catch (e){
    document.writeln(false);
  }

  true*/

  /*let x = 0;
  ( () => {
    x = 2;
    return x;
  })();

  try {
    document.writeln(x === 0);
  } catch (e){
    document.writeln(false);
  }*/

  // x false  let x false*/

  /*let x = 0;
  function() {
    let x = 2;
    return x;
  }();

  try {
    document.writeln(x === 0);
  } catch (e){
    document.writeln(false);
  }

  false*/

  /*const id1 = x => x;
  const id2 = y => y;

  document.writeln(id1(1)===id2(1));

  const id = x=> x;

  const a1 = y => id(y);
  const a2 = y => y;

  document.writeln(a1(2)===a2(2));

  const konst = x => y => x;

  const k1 = x => y => konst(id)(x)(y);
  const k2 = x      => konst(id)(x);
  const k3 =           konst(id);

  document.writeln(k1(2)(2) === k2(2)(2));
  document.writeln(k2(1)(2) === k3(2)(2));

  document.writeln(id(1)===konst(1)(2));



  const F1 = x => (x=>x);
  const F2 = y => (x=>y);

  document.writeln(F1(1)(0)===F2(1)(0));*/

  /*const id = x=> x;
  const konst = x => y => x;

  const sndp = konst(id);


  const T = konst;

  const F = sndp;
const pair = a => b => f => f(a)(b);
const fst = p => p(T);
const snd = p => p(F);

const pairEq = a => b => fst(a) === fst(b) && snd(a) === snd(b);*/

// const pairPlus = a => b => pair (fst(a) + fst(b)) (snd(a) + snd(b));

//   const pairMap = f => p => pair (f(fst(p))) (f(snd(p)));
//
//
// const oneTwo = pair(1)(2);
// const square = x => x * x;
// const result = pairMap (square) (oneTwo);
//
// document.writeln(pairEq(result)(pair(1)(4)));


//true

  // Week 4

  // map; takes every element and creates a new "value" for it

  /*const times = a => b => a * b;

  const twoTimes = times(2);

  document.writeln([1,2,3].map(x => times(2)(x)));
  //Eta reduction
  document.writeln([1,2,3].map(times(2)));
  //Is assigned to another variable
  document.writeln([1,2,3].map(twoTimes));


  const twice = a => 2 * a;

  document.writeln("This is the test: "+ [1,2,3].map(twice));*/


  // filter; retain all elements that fulfill decleration

  /*const odd = x => x % 2 === 1;

  document.writeln([1,2,3].filter(x=>x%2===1));
  //Putting const in
  document.writeln([1,2,3].filter(x => odd(x)));
  //Eta reduction
  document.writeln([1,2,3].filter(odd));

  const divides = x => y => (y / x) % 1 === 0;

  document.writeln("TZhis is the test: "+[1,2,3,4,5,6].filter(divides(3)))*/



  //reduce; takes an array but doesnt work with single element, but rather multiple elements
  // "combined" elements
  /*const plus = (accu, curr) => accu + curr;

  document.writeln([1,2,3].reduce((accu,curr) => accu + curr));
  document.writeln([1,2,3].reduce(plus));
  document.writeln([1,2,3].reduce(plus, 0));

  const join = x => (val1, val2) => val1 +""+x+""+val2;

  document.writeln("This is the test: "+[1,2,3].reduce(join('-')));*/

  // const e = {revenue: 10000, bonus: null};
  //
  // const bonusFormula = "employee.bonus = employee.revenue * 0.3";
  //
  // const bonusFormula2 = "employee.revenue * 0.3"
  //
  // const bonusCalculation = employee => eval(bonusFormula);
  //
  //
  // //const bonusCalculation = Function("employee", "return employee.bonus = "+bonusFormula2+";")
  //
  //
  // //take bonusFormula and split it up in all single fields, so they can be used by others, e.g. factor_
  //
  // document.writeln(bonusCalculation(e));
  //
  // document.writeln(e.bonus === e.revenue * 0.3);


  /*function Empty() {}

  const empty = new Empty();

  Empty.prototype.answer = 42;

  document.writeln(empty.answer === 42)

  True
  */


  /*const Empty = ( () => {
    function Empty() {}
    return Empty;
  }) ();

  const empty = Empty;

  document.writeln(empty instanceof Empty)

  False
  */

  /*const Empty = ( () => {
    function Empty() {}
    return Empty;
  }) ();

  const empty = new Empty;
  const also = new Empty;

  Empty.prototype.answer = 42;

  document.writeln(
          empty.answer === 42 && also.answer === 42
  );

  True*/

  /*const Empty = ( () => {
    function Empty() {}
    return Empty;
  }) ();

  const empty = new Empty;

  document.writeln(empty instanceof Empty)


  True*/


  /*const Person = name => {
    let age = 0;
    return {
      getAge: () => age,
      setAge: newAge => age = newAge,
      getName: () => name,
      setName: newName => name = newName
    }
  };*/

 /* const me = Person("Myself");
  me.name = "***";
  document.writeln(me.getName() === "***");

  False
  */

  /*const me = Person("Myself");
  me.setAge(50);
  document.writeln(me.getAge() === 50);

  True*/

  /*const me = Person("Myself");
  me.setName("Sherlock");
  document.writeln(me.getName() === "Sherlock");


  True*/



/*
  Going through an empty array and indexing the positions

  Array.from( {length:5}, (el, idx) => idx);

*/

  /*
  True

  function Todo(text) {
    let done = false;
    const check = () => done = true;
    return {
      getText: () => text,
      isDone: () => done,
      check: check
    }
  }

  let todo = new Todo("buy milk");
  todo.check();
  document.writeln(todo.isDone());

                    */

  /*false

  function Todo(text) {
    const done = false;
    return {
      getText: () => text,
      isDone: () => done,
      check: () => done = true
    }
  }
  let todo = Todo("buy milk");
  todo.check();
  document.writeln(todo.isDone())*/

  /*false

  function Todo(text) {
    let done = false;
    return {
      getText: () => text,
      isDone: () => done,
      check: done = true
    }
  }

  let todo = Todo("buy milk");
  todo.check();
  document.writeln(todo.isDone());*/

  /*true

  function Todo(text, done) {
    const check = () => done = true;
    return {
      getText: () => text,
      isDone: () => done,
      check: check
    }
  }

  let todo = Todo("buy milk", false);
  todo.check();
  document.writeln(todo.isDone());
*/

 /* true

  function Todo(text) {
    let done = false;
    return {
      getText: () => text,
      isDone: () => done,
      check: () => done = true
    }
  }

  let todo = Todo("buy milk");
  todo.check();
  document.writeln(todo.isDone())*/

  /*true

  function Todo(text, done) {
    function check() {done = true};
    return {
      getText: () => text,
      isDone: () => done,
      check: check
    }
  }

  let todo = Todo("buy milk", false);
  todo.check();
  document.writeln(todo.isDone());*/

  /*function Todo(text) {
    let done = false;
    const check = () => done = true;
    return {
      getText: () => text,
      isDone: () => done,
      check: check
    }
  }

  let todo = Todo("buy milk");
  todo.check();
  document.writeln(todo.isDone());*/

  /*

  const failSafe = defaultValue => callback => arg => {
    try {
      return callback(arg);
    } catch(e) {
      return defaultValue;
    }
  };

  const doError = x => { throw new Error() };
  const errorCount = failSafe (1) (doError);

  document.writeln(failSafe(false)(x=>x)(true) && failSafe (true) (doError) (null) && errorCount(null) === 1)*/

  /*function handle(callback){
    const result = [];
    callback(result);
    return result;
  }

  document.writeln( handle( it => it.push(1)).length === 1)

  true

  */

 /* function handle(callback) {
    const result = [];
    return callback ( result );
  }

  document.writeln( handle ( () => [1]).length === 1)

  true*/

  /*function handle(callback) {
    const result = [];
    callback(result);
    return result;
  }

  let it = [];
  document.writeln( handle( () => it.push(1)).length === 1)

  false*/

  /*function handle (callback) {
    const result = [];
    callback(result);
    callback(result);
    return result;
  }

  document.writeln( handle ( it => it.push(1)).length === 2)

  true*/

  /*function handle (callback) {
    const result = [];
    callback( result );
    return result;
  }

  document.writeln( handle( () => [1]).length === 1)

  false*/

  /*function handle(callback) {
    const result = [];
    callback(result);
    return result;
  }

  let it = [];
  document.writeln( handle( it => it.push(1)).length === 1)

  true*/

  /*function handle(callback) {
    return callback( [] );
  }

  document.writeln( handle(it => {it.push(1); return it;}).length === 1)

  true*/

  /*function handle(callback) {
    const result = [];
    callback(result);
    return result;
  }

  document.writeln(handle( it.push(1)).length === 1)

  false */

  /*function handle( callback) {
    const result = [];
    callback([]);
    return result;
  }

  document.writeln(handle(it => it.push(1)).length === 1)

  false */

  /*function handle(count, callback) {
    const result = [];
    for (let i = 0; i < count; i++) {
      callback(result);
    }
    return result;
  }

  document.writeln(handle(3, it => it.push(1)).length === 3)

  true*/

  /*function handle (callback) {
    const result = [];
    callback(result);
    return result;
  }

  let it = [];
  document.writeln( handle(it.push(1)).length === 1)

  false*/

  /*function handle(callback) {
    const result = [];
    callback(result);
    return result;
  }

  document.writeln(handle( () => it.push(1)).length === 1)

  false*/

  /*const idPromise = x => new Promise( resolve => resolve(x));

  const writer = x => {
    document.writeln(x);
    return idPromise(x);
  };

  const filterEven = n => {
    if ( n % 2 === 0) return n; else throw Error("not even");
  };

  idPromise(1)
          .then(writer)
          .then(filterEven)
          .then(writer)
          .catch(err => {});*/

  /*const idPromise = x => new Promise( resolve => resolve(x));

  idPromise(1)
          .then(it => it)
          .then(it => document.writeln(it));
*/

  /*const idPromise = x => new Promise( resolve => resolve(x));

  const writer = x => {
    document.writeln(x);
    return idPromise(x);
  };

  idPromise(1)
          .then(writer)
          .then(it => it + 1)
          .then(writer)*/

  /*const idPromise = x => new Promise( resolve => resolve(x));

  document.writeln(idPromise(1));*/

  /*const idPromise = x => new Promise( resolve => resolve(x));

  idPromise(1)
          .then( it => {document.writeln(it); return it; })
          .then( it => document.writeln(it));*/

  /*const idPromise = x => new Promise( resolve => resolve(x));

  const writer = x => {
    document.writeln(x);
    return idPromise(x);
  }

  idPromise(1)
          .then(writer)
          .then(it => document.writeln(it));*/

  /*const idPromise = x => new Promise( resolve => resolve(x));

  const writer = x => {
    document.writeln(x);
    return idPromise(x);
  }

  const filterEven = n => n % 2 === 0 ? n : undefined;

  idPromise(1)
          .then(writer)
          .then(filterEven)
          .then(writer);*/

  /*const idPromise = x => new Promise( resolve => resolve(x));

  const writer = x => {
    document.writeln(x);
    return idPromise(x);
  }

  const inc = n => n + 1;
  const filterEven = n => n % 2 === 0 ? n : undefined;

  idPromise(1)
          .then(writer)
          .then(inc)
          .then(writer)
          .then(filterEven)
          .then(writer)
  */

  /*const idPromise = x => new Promise( resolve => resolve(x));

  idPromise(1)
          .then(it => document.writeln(it));*/

  /*const idPromise = x => new Promise(resolve => resolve(x));
  const failPromise = err => new Promise( (resolve, reject) => reject(err));

  const writer = x => {
    document.writeln(x);
    return idPromise(x);
  };

  const inc = n => idPromise(n + 1);

  const foo = async i => {
    let x = await idPromise(i);
    while(x < 4) {
      x = await writer(x);
      x = await inc(x);
    }
  };

  foo(1);*/

  /*const idPromise = x => new Promise(resolve => resolve(x));
  const failPromise = err => new Promise( (resolve, reject) => reject(err));

  const writer = x => {
    document.writeln(x);
    return idPromise(x);
  };*/

  /*const foo = async i => {
    let x = await idPromise(i);
    x = await writer(x);
  }

  foo(1);*/

  // const fooo = async i => {
  //   let x = await idPromise(i);
  //   x.then(writer);
  // }

  /*const foo = async i => {
    let x = await idPromise(i);
    document.writeln(x);
  }*/

  /*const inc = n => idPromise(n + 1);
  const filterEven = n => n % 2 === 0 ? idPromise(n): failPromise("not even");

  const foo = async i => {
    let x = await idPromise(i);
    while (x < 4) {
      x = await filterEven(x);
      x = await writer(x);
      x = await inc(x);
    }
  };

  foo(1);*/

  /*const inc = n => idPromise(n + 1);
  const filterEven = n => n % 2 === 0 ? idPromise(n): failPromise("not even");

  const foo = async i => {
    let x = await idPromise(i);
    while (x < 4) {
      x = await filterEven(x).catch( err => {});
      x = await writer(x);
      x = await inc(x);
    }
  };

  foo(1);*/

  /*const inc = n => idPromise(n + 1);
  const filterEven = n => n % 2 === 0 ? idPromise(n): failPromise("not even");

  const foo = async i => {
    let x = await idPromise(i);
    while (x < 4) {
      x = await filterEven(x);
      x = await writer(x);
      x = await inc(x);
    }
  };

  foo(1);*/

  /*const inc = n => idPromise(n + 1);
  const filterEven = n => n % 2 === 0 ? idPromise(n): failPromise("not even");

  const foo = async i => {
    let x = await idPromise(i);
    while (x < 4) {
      x = await filterEven(x);
      x = await writer(x);
      x = await inc(x);
    }
  };

  foo(1);*/

 /* const idPromise = x =>new Promise( resolve => resolve(x));

  const failPromise = err => new Promise(( resolve, reject ) => reject(err));

  const foo = async i => {
    let x = await idPromise(i);
    document.writeln(x);
  };

  foo(1);
*/

/*  const NullSafe = x => {

    const isNullSafe = y => y && y.then;

    const maywrap = y => isNullSafe(y) ? y : NullSafe(y); // if y is not NullSafe yet, make it so

    return {

      then: fn => {

        if(x !== null && x !== undefined) {

          const result = fn(x);

          return maywrap(result);

        }

        return NullSafe(null);

      }

    };

  };*/

  const NullSafe = x => {

    const isNullSafe = y => y && y.then;
    const maywrap = y => isNullSafe(y) ? y : NullSafe(y); // if y is not NullSafe yet, make it so

    return {
      then: fn => {  // see(1)
        if(x !== null) {
          const result = fn(x);
          return maywrap(result);
        }
        return NullSafe(null);
      }
    };
  };

  /*Fill the gaps such that NullSafe objects can be chained with their "then" function
just like Promises do, incl. auto-promotion of result values to NullSafe objects.*/

  NullSafe(1).then(console.log); // will call the log
  NullSafe(null).then(console.log); // will not call the log
  NullSafe(2).then( x => null).then(console.log); // will not call the log

  // x_ and y_ are given. do not override.
  const x_ = 3;
  let y_ = 2;
  document.writeln(
          NullSafe(x_)
                  .then( x => x*2) // must auto-promote
                  .then( x => NullSafe(x)) // must not auto-promote
                  .then( x => y_ = x + 1) // store value, check no double promotion
                  .then( x => null) // jump over rest
                  .then( x => x.mustNotBeCalled) !== null && y_ === x_ * 2 + 1
  )

 /* const  str2chars = str => [...str];
  const isAlpha = char => char.match(/[a-z]/);

  const palindrome = str => {
    const lcStr = str.toLowerCase();
    const str1 = str2chars(lcStr);
    const str2 = [];
    for (let i = 0; i < str1.length; i++) {
      if(isAlpha(str1[i])) {
        str2.push(str1[i]);
      }
    }
    const str2Len = str2.length;
    for (let i = 0; i < str2Len; i++) {
      if(str2[i] !== str2[str2Len-i-1]) {
        return false;
      }
    }
    return true;
  };




  /!*const palindrome = str => {
    const processedStr = str2chars(str.toLowerCase()).filter(isAlpha);
    return processedStr.join('') === processedStr.reverse().join('');
  };*!/
  document.writeln(palindrome("Amore, Roma!") && palindrome("Madam, I'm Adam!") && palindrome("Never odd or even.") && !palindrome("Amore"));*/

  // const Scheduler = () => {
  //   let inProcess = false;
  //   const tasks = [];
  //   function process() {
  //     if (inProcess) return;
  //     if (tasks.length === 0) return;
  //     inProcess = true;
  //     const task = tasks.pop();
  //     const prom = new Promise( ok => task(ok) );
  //     prom.then( _ => {
  //       inProcess = false;
  //       process();
  //     });
  //   }
  //   function add(task) {
  //     tasks.unshift(task);
  //     process();
  //   }
  //   return {
  //     add:   add,
  //     addOk: task => add( ok => { task(); ok(); }) // convenience
  //   }
  // };

  // let state = 3;
  //
  // const scheduler = Scheduler();
  // scheduler.add(ok => {
  //   setTimeout(_ => {
  //     state = state - 2;
  //     ok();
  //   }, 100)
  // });
  //
  // scheduler.add(ok => {
  //   state = state - 1;
  //   ok();
  // });
  //
  // scheduler.add(ok => {
  //   document.writeln(state);
  //   ok();
  // });

  // let state = [0]
  //
  // const scheduler = Scheduler();
  // scheduler.add(ok => {
  //   setTimeout(_ => {
  //     state.push(1)
  //     ok();
  //   }, 100)
  // });
  //
  // scheduler.add(ok => {
  //   state.push(2)
  //   ok();
  // });
  //
  //
  // document.writeln(state);

  /*let state = 3;

  const scheduler = Scheduler();
  scheduler.add(ok => {
    setTimeout(_ => {
      state = state - 2;
      ok();
    }, 100)
  });

  scheduler.add(ok => {
    state = state - 1;
    ok();
  });

  scheduler.add(ok => {
    console.log(state);
    ok();
  });

  console.log("x");
*/

 /* const DataFlowVariable = createValue => {
    let value = undefined;
    return () => {
      if (value !== undefined) { return value }
      value = createValue();
      return value;
    }
  };

  // const x = DataFlowVariable(() => y() * 2);
  // let y = DataFlowVariable(() => 1);
  //
  // x();
  // y = DataFlowVariable(() => 2);
  //
  // document.writeln(x());

  const x = DataFlowVariable(() => y() * 2);
  const y = DataFlowVariable(() => 1);



  document.writeln(x());*/

</script>
</body>
</html>

